function exportRankedTasks() {
    // Collect data directly from the preview table
    const previewBody = document.getElementById('tasksPreviewBody');
    const rows = previewBody.querySelectorAll('tr');

    const exportData = Array.from(rows).map(row => {
        const cells = row.querySelectorAll('td');
        return {
            'Rank': cells[13].textContent,
            'Task ID': cells[0].textContent,
            'Description': cells[1].textContent,
            'Min Duration (s)': cells[2].textContent,
            'Max Duration (s)': cells[3].textContent,
            'With Partner': cells[4].textContent,
            'Finisher': cells[5].textContent,
            'Punishment': cells[6].textContent,
            'Dom Sexy Bits': cells[7].textContent,
            'Sub Sexy Bits': cells[8].textContent,
            'Toy Types': cells[9].textContent,
            'KNK Preferences': cells[10].textContent,
            'ELO Rating': cells[11].textContent,
            'Comparisons': cells[12].textContent,
            'Was Rated': taskRatings[cells[0].textContent].wasRated
        };
    });

    // Get current date in YYYY-MM-DD format
    const currentDate = new Date().toISOString().split('T')[0];
    
    // Create filename with current date
    const filename = `tasks_compared-${currentDate}.xlsx`;

    // Create workbook and worksheet
    const worksheet = XLSX.utils.json_to_sheet(exportData);
    const workbook = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(workbook, worksheet, 'Ranked Tasks');

    // Export the file
    XLSX.writeFile(workbook, filename, { compression: true });
}
