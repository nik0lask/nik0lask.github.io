<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Festival Timeline App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            color: #ffffff;
            background: linear-gradient(-45deg, #000000, #00ff00, #ffffff);
            background-size: 400% 400%;
            animation: gradient 10s ease infinite;
        }
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .glitch {
            animation: glitch 1.5s infinite;
            text-shadow: 0 0 5px #00ff00, 0 0 10px #00b7eb;
        }
        @keyframes glitch {
            0% { transform: translate(0); }
            10% { transform: translate(-2px, 2px); }
            20% { transform: translate(2px, -2px); }
            30% { transform: translate(0); }
            100% { transform: translate(0); }
        }
        #current-set {
            background: rgba(0, 0, 0, 0.8);
            box-shadow: 0 0 15px #00ff00;
            border: 1px solid #00b7eb;
        }
        .primary-button {
            background: #00ff00;
            border: #000000 1px solid;
            color: #000000;
            font-weight: bold;
            box-shadow: 0 0 15px #00ff00;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            border-radius: 1rem;
        }
        .primary-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px #ff00ff;
        }
        .secondary-button {
            background: rgba(0, 0, 0, 0.9);
            color: #ffffff;
            box-shadow: 0 0 10px #00b7eb;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            border-radius: 1rem;
            min-height: 100px;
            line-height: 1.5;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .secondary-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px #ff00ff;
        }
        .tertiary-link {
            color: #000000;
            font-weight: bold;
            text-decoration: none;
            transition: text-shadow 0.2s ease;
        }
        .tertiary-link:hover {
            text-shadow: 0 0 10px #00b7eb;
        }
        .time-picker {
            display: flex;
            justify-content: center;
            gap: 1rem;
            position: relative;
            height: 120px;
            margin-bottom: 1rem;
        }
        .time-scroll {
            width: 80px;
            height: 100%;
            overflow-y: scroll;
            scroll-snap-type: y mandatory;
            scroll-behavior: smooth;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #00ff00;
            border-radius: 0.25rem;
            text-align: center;
            scrollbar-width: none;
            -ms-overflow-style: none;
            box-shadow: 0 0 10px #00b7eb;
        }
        .time-scroll::-webkit-scrollbar {
            display: none;
        }
        .time-option {
            height: 40px;
            line-height: 40px;
            font-size: 1.2rem;
            cursor: pointer;
            scroll-snap-align: center;
            transition: background 0.2s;
            color: #ffffff;
        }
        .time-option.selected {
            background: #ff00ff;
            font-weight: bold;
            box-shadow: 0 0 10px #00ff00;
        }
        .time-picker::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 40px;
            background: rgba(0, 255, 0, 0.3);
            transform: translateY(-50%);
            pointer-events: none;
            z-index: 10;
        }
        #map-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 20;
            justify-content: center;
            align-items: center;
            padding: 0.5rem;
        }
        #map-modal img {
            max-width: min(85vw, 350px);
            max-height: 85vh;
            border-radius: 0.5rem;
            object-fit: contain;
            border: 2px solid #00ff00;
            box-shadow: 0 0 15px #ff00ff;
        }
        #close-map {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
        }
    </style>
</head>
<body class="p-4">
    <div class="max-w-md mx-auto" style="display: flex; align-items: center; justify-content: center; flex-direction: column;">
        <h1 class="text-3xl font-bold text-center mb-4 fade-in glitch">Drum & Bass Festival</h1>
        <div id="current-time" class="text-lg text-center text-gray-200 mb-2 fade-in glitch"></div>
        <div id="current-set" class="text-xl font-semibold text-center p-4 rounded-lg mb-4 fade-in glitch"></div>
        <div id="alternatives" class="flex flex-col gap-2 mb-4"></div>
        <div id="next-set" class="flex flex-col gap-2 mb-4 fade-in"></div>
        <button id="show-map" class="tertiary-link text-center py-2 fade-in">Show Venue Map</button>
        <div id="time-selection" class="flex flex-col gap-2 fade-in mt-4" style="margin-top: 24px;">
            <div class="time-picker">
                <div id="hours-scroll" class="time-scroll"></div>
                <div id="minutes-scroll" class="time-scroll"></div>
            </div>
            <button id="set-time" class="primary-button py-2 px-4 fade-in">Set Time</button>
            <button id="reset-time" class="tertiary-link text-center py-2 fade-in">Reset to Current Time</button>
        </div>
    </div>
    <div id="map-modal" class="flex">
        <div class="relative">
            <img src="https://nik0lask.github.io/allstars-map.jpg" alt="Venue Map">
            <button id="close-map" class="tertiary-button py-1 px-2 rounded">Close</button>
        </div>
    </div>

    <script>
        const timeline = [
            { start: '13:00', end: '13:30', primary: 'T & SUGAH [BASS ODYSSEY]', secondary: null, tertiary: null },
            { start: '13:30', end: '14:30', primary: 'UPGRADE B2B GINO + HARRY SHOTTA [NEON JUNGLE]', secondary: 'CHARLIE TEE + SAVVY B [BASS ODYSSEY]', tertiary: null },
            { start: '14:30', end: '15:15', primary: 'BLADERUNNER B2B CROSSY + CARASEL [BASS ODYSSEY]', secondary: 'FLAVA D + COMMA DEE [NEON JUNGLE]', tertiary: null },
            { start: '15:15', end: '16:00', primary: 'ANDROMEDIK [NEON JUNGLE]', secondary: null, tertiary: null },
            { start: '16:00', end: '17:00', primary: 'CAMO & KROOKED [NEON JUNGLE]', secondary: 'MONRROE + DUSKEE [DREAMSCAPE]', tertiary: 'TURNO B2B DISRUPTA + DREPS [BASS ODYSSEY]' },
            { start: '17:00', end: '17:20', primary: 'EMILY MAKIS [NEON JUNGLE]', secondary: 'JUNGLE CAKES + NAVIGATOR [STARDUST]', tertiary: null },
            { start: '17:20', end: '18:10', primary: 'LENS B2B GRAY [SUNBURST]', secondary: 'JUNGLE CAKES + NAVIGATOR [STARDUST]', tertiary: null },
            { start: '18:10', end: '19:00', primary: 'KANINE + RAGE [BASS ODYSSEY]', secondary: 'MACKY GEE + B-LINE [DRUMFIRE]', tertiary: null },
            { start: '19:00', end: '19:45', primary: 'ANDY C + TONN PIPER [BASS ODYSSEY]', secondary: null, tertiary: null },
            { start: '19:45', end: '20:45', primary: 'BOU & BLIVE 24/7 [NEON JUNGLE]', secondary: 'MEFJUS + MAKSIM [DREAMSCAPE]', tertiary: 'ARCANDO [DRUMFIRE]' },
            { start: '20:45', end: '21:00', primary: 'ANDY C + TONN PIPER [BASS ODYSSEY]', secondary: null, tertiary: null },
            { start: '21:00', end: '22:00', primary: 'A.M.C + PHANTOM [SUNBURST]', secondary: 'IMANU [DREAMSCAPE]', tertiary: null }
        ];

        let useCustomTime = false;
        let customTime = null;
        let selectedHour = null;
        let selectedMinute = null;
        let hoursScroll = null;
        let minutesScroll = null;

        function timeToMinutes(time) {
            const [hours, minutes] = time.split(':').map(Number);
            return hours * 60 + minutes;
        }

        function getCurrentTime() {
            if (useCustomTime && customTime) {
                return customTime;
            }
            return new Date();
        }

        function getCurrentSlot() {
            const now = getCurrentTime();
            const currentMinutes = now.getHours() * 60 + now.getMinutes();
            document.getElementById('current-time').innerText = `Current Time: ${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
            document.getElementById('current-time').classList.add('fade-in');

            for (let slot of timeline) {
                const startMinutes = timeToMinutes(slot.start);
                const endMinutes = timeToMinutes(slot.end);
                if (currentMinutes >= startMinutes && currentMinutes < endMinutes) {
                    return slot;
                }
            }
            return null;
        }

        function getNextSlot() {
            const now = getCurrentTime();
            const currentMinutes = now.getHours() * 60 + now.getMinutes();
            for (let i = 0; i < timeline.length; i++) {
                const startMinutes = timeToMinutes(timeline[i].start);
                if (startMinutes > currentMinutes) {
                    return timeline[i];
                }
            }
            return null;
        }

        let currentChoice = 'primary';

        function displaySlot(slot) {
            const currentSetDiv = document.getElementById('current-set');
            const alternativesDiv = document.getElementById('alternatives');
            const nextSetDiv = document.getElementById('next-set');
            alternativesDiv.innerHTML = '';
            nextSetDiv.innerHTML = '';

            if (!slot) {
                currentSetDiv.innerText = 'No active set right now.';
                currentSetDiv.classList.add('fade-in');
            } else {
                const chosenSet = slot[currentChoice] || slot.primary;
                currentSetDiv.innerText = `${currentChoice.charAt(0).toUpperCase() + currentChoice.slice(1)} Set: ${chosenSet}\n(${slot.start} - ${slot.end})`;
                currentSetDiv.classList.add('fade-in');

                // Add buttons for other available sets
                if (currentChoice !== 'primary' && slot.primary) {
                    const button = document.createElement('button');
                    button.className = 'secondary-button py-3 px-4 fade-in';
                    button.innerText = `Switch to Primary: ${slot.primary}`;
                    button.onclick = () => {
                        currentChoice = 'primary';
                        displaySlot(slot);
                    };
                    alternativesDiv.appendChild(button);
                }

                if (currentChoice !== 'secondary' && slot.secondary) {
                    const button = document.createElement('button');
                    button.className = 'secondary-button py-3 px-4 fade-in';
                    button.innerText = `Switch to Secondary: ${slot.secondary}`;
                    button.onclick = () => {
                        currentChoice = 'secondary';
                        displaySlot(slot);
                    };
                    alternativesDiv.appendChild(button);
                }

                if (currentChoice !== 'tertiary' && slot.tertiary) {
                    const button = document.createElement('button');
                    button.className = 'secondary-button py-3 px-4 fade-in';
                    button.innerText = `Switch to Tertiary: ${slot.tertiary}`;
                    button.onclick = () => {
                        currentChoice = 'tertiary';
                        displaySlot(slot);
                    };
                    alternativesDiv.appendChild(button);
                }
            }

            // Display next set
            const nextSlot = getNextSlot();
            if (nextSlot) {
                const button = document.createElement('button');
                button.className = 'primary-button py-2 px-4 fade-in';
                button.innerText = `Next Set: ${nextSlot.primary} (${nextSlot.start} - ${nextSlot.end})`;
                button.onclick = () => {
                    const [hours, minutes] = nextSlot.start.split(':').map(Number);
                    customTime = new Date();
                    customTime.setHours(hours, minutes, 0, 0);
                    useCustomTime = true;
                    selectedHour = hours;
                    selectedMinute = minutes;
                    document.querySelectorAll('#hours-scroll .time-option').forEach(opt => opt.classList.remove('selected'));
                    document.querySelectorAll('#minutes-scroll .time-option').forEach(opt => opt.classList.remove('selected'));
                    const hourOption = document.querySelector(`#hours-scroll .time-option:nth-child(${hours + 1})`);
                    const minuteOption = document.querySelector(`#minutes-scroll .time-option:nth-child(${minutes + 1})`);
                    if (hourOption) hourOption.classList.add('selected');
                    if (minuteOption) minuteOption.classList.add('selected');
                    hoursScroll.scrollTo({ top: hours * 40, behavior: 'smooth' });
                    minutesScroll.scrollTo({ top: minutes * 40, behavior: 'smooth' });
                    displaySlot(nextSlot);
                };
                nextSetDiv.appendChild(button);
            }
        }

        function debounce(func, wait) {
            let timeout;
            return function (...args) {
                clearTimeout(timeout);
                timeout = setTimeout(() => func.apply(this, args), wait);
            };
        }

        function populateTimePickers() {
            hoursScroll = document.getElementById('hours-scroll');
            minutesScroll = document.getElementById('minutes-scroll');

            for (let i = 0; i < 24; i++) {
                const hour = document.createElement('div');
                hour.className = 'time-option';
                hour.innerText = i.toString().padStart(2, '0');
                hour.onclick = () => {
                    selectedHour = i;
                    document.querySelectorAll('#hours-scroll .time-option').forEach(opt => opt.classList.remove('selected'));
                    hour.classList.add('selected');
                    hoursScroll.scrollTo({ top: i * 40, behavior: 'smooth' });
                };
                hoursScroll.appendChild(hour);
            }

            for (let i = 0; i < 60; i++) {
                const minute = document.createElement('div');
                minute.className = 'time-option';
                minute.innerText = i.toString().padStart(2, '0');
                minute.onclick = () => {
                    selectedMinute = i;
                    document.querySelectorAll('#minutes-scroll .time-option').forEach(opt => opt.classList.remove('selected'));
                    minute.classList.add('selected');
                    minutesScroll.scrollTo({ top: i * 40, behavior: 'smooth' });
                };
                minutesScroll.appendChild(minute);
            }

            hoursScroll.addEventListener('scroll', debounce(() => {
                const scrollTop = hoursScroll.scrollTop;
                const optionHeight = 40;
                const index = Math.round(scrollTop / optionHeight);
                selectedHour = index;
                document.querySelectorAll('#hours-scroll .time-option').forEach(opt => opt.classList.remove('selected'));
                const options = hoursScroll.querySelectorAll('.time-option');
                if (options[index]) {
                    options[index].classList.add('selected');
                    hoursScroll.scrollTo({ top: index * 40, behavior: 'smooth' });
                }
            }, 100));

            minutesScroll.addEventListener('scroll', debounce(() => {
                const scrollTop = minutesScroll.scrollTop;
                const optionHeight = 40;
                const index = Math.round(scrollTop / optionHeight);
                selectedMinute = index;
                document.querySelectorAll('#minutes-scroll .time-option').forEach(opt => opt.classList.remove('selected'));
                const options = minutesScroll.querySelectorAll('.time-option');
                if (options[index]) {
                    options[index].classList.add('selected');
                    minutesScroll.scrollTo({ top: index * 40, behavior: 'smooth' });
                }
            }, 100));
        }

        // Handle custom time input
        document.getElementById('set-time').addEventListener('click', () => {
            if (selectedHour !== null && selectedMinute !== null) {
                customTime = new Date();
                customTime.setHours(selectedHour, selectedMinute, 0, 0);
                useCustomTime = true;
                const slot = getCurrentSlot();
                displaySlot(slot);
            }
        });

        // Reset to current time
        document.getElementById('reset-time').addEventListener('click', () => {
            useCustomTime = false;
            customTime = null;
            selectedHour = null;
            selectedMinute = null;
            document.querySelectorAll('#hours-scroll .time-option').forEach(opt => opt.classList.remove('selected'));
            document.querySelectorAll('#minutes-scroll .time-option').forEach(opt => opt.classList.remove('selected'));
            const slot = getCurrentSlot();
            displaySlot(slot);
        });

        // Show/hide map modal
        document.getElementById('show-map').addEventListener('click', () => {
            document.getElementById('map-modal').style.display = 'flex';
        });

        document.getElementById('close-map').addEventListener('click', () => {
            document.getElementById('map-modal').style.display = 'none';
        });

        // Initial setup
        populateTimePickers();
        let slot = getCurrentSlot();
        displaySlot(slot);

        // Update every minute if not using custom time
        setInterval(() => {
            if (!useCustomTime) {
                slot = getCurrentSlot();
                displaySlot(slot);
            }
        }, 60000);
    </script>
</body>
</html>
